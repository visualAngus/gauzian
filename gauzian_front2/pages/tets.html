<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAUZIAN - DRIVE</title>
    <link rel="stylesheet" href="../styles/global.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <style>

    </style>
</head>

<body>
    <header>
        <h1><a href="/">GZDRIVE</a></h1>
        <div class="div_user_profil">
            <div class="div_profil_custom"></div>
            <img class="user-image" src="../images/user_profile.png" alt="User Profile" onload="imageLoaded()">
        </div>
    </header>

    <section>
        <div class="div_left_part">
            <nav>
                <ul>
                    <li><a href="#mon_drive" onclick="navigateToSection('mon_drive')">Mon Drive</a></li>
                    <li><a href="#partages" onclick="navigateToSection('partages')">Partagés avec moi</a></li>
                    <li><a href="#partages_par_moi" onclick="navigateToSection('partages_par_moi')">Partagés par moi</a>
                    </li>
                    <li><a href="#favoris" onclick="navigateToSection('favoris')">Favoris</a></li>
                    <li><a href="#corbeille" onclick="navigateToSection('corbeille')">Corbeille</a></li>
                </ul>
            </nav>
        </div>
        <div class="div_right_part">
            
        </div>

    </section>


    <script>
        let active_path_with_id = [];


        function imageLoaded() {
            const placeholder = document.querySelector('.div_profil_custom');
            const userImage = document.querySelector('.user-image');
            placeholder.classList.add('hidden');
            userImage.classList.add('loaded');
        }
        function display_path_graphique(path) {
            const pathContainer = document.querySelector('.div_path_graphique');
            pathContainer.innerHTML = ''; // Clear existing content

            const pathParts = path.split('/').filter(part => part !== '');
            pathParts.forEach((part, index) => {
                const pathDiv = document.createElement('div');
                pathDiv.classList.add('div_folder_path_grap');

                const span = document.createElement('span');
                span.textContent = part;
                pathDiv.appendChild(span);
                pathContainer.appendChild(pathDiv);

                if (index < pathParts.length - 1) {
                    const separatorDiv = document.createElement('div');
                    separatorDiv.classList.add('div_folder_separator');

                    const separatorSpan = document.createElement('span');
                    separatorSpan.textContent = '/';
                    separatorDiv.appendChild(separatorSpan);
                    pathContainer.appendChild(separatorDiv);
                }
            });
        }

        function openFolder(folderId, folderName) {
            active_path_with_id.push({ id: folderId, name: folderName });
            const pathString = active_path_with_id.map(item => item.name).join('/');
            display_path_graphique(pathString);
            // Additional logic to load folder contents can be added here
        }

        function navigateToSection(sectionId) {
            history.pushState(null, '', `#${sectionId}`);
            // Optionally, you can add logic here to handle section visibility or other actions
            console.log(`Navigated to section: ${sectionId}`);

            // select the li corresponding to the sectionId and add a class 'active' to it, remove the class from other li
            const navLinks = document.querySelectorAll('nav ul li a');
            navLinks.forEach(link => {
                if (link.getAttribute('href') === `#${sectionId}`) {
                    link.classList.add('active');
                    if (sectionId === 'mon_drive') {
                        display_path_graphique('Mon Drive');
                    } else {
                        section_name = sectionId.split('_').map((word, index) =>
                            index === 0 ? word.charAt(0).toUpperCase() + word.slice(1) : word
                        ).join(' ');
                        display_path_graphique(["Mon Drive", section_name].join('/'));
                    }
                } else {
                    link.classList.remove('active');
                }
            });
        }

        function load_folder(id_parent) {
            // fetch un get 
            fetch(`/api/drive/folder/${id_parent}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Folder data:', data);
                    // Process and display folder data as needed
                })
                .catch((error) => {
                    console.error('Error fetching folder data:', error);
                });
        }


        // Handle initial navigation based on URL hash
        window.addEventListener('load', () => {
            const hash = window.location.hash.substring(1); // Remove the '#' character
            if (hash) {
                navigateToSection(hash);
            }
        });

    </script>
</body>

</html>